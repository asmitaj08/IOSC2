<html>
<head>
<meta http-equiv="Content-Type" content="text/html;">
<title>TRENDNET | modelName | Wireless | Advanced</title>
<link rel="stylesheet" href="style.css" type="text/css">
<script language="JavaScript" src="uk.js"></script>

<script language="JavaScript" src="public_js/public.js"></script>
<script language="Javascript" src="js/jquery-1.3.2.min.js"></script>
<script language="Javascript" src="js/xml.js"></script>
<script language="Javascript" src="js/object.js"></script>
<SCRIPT LANGUAGE="JavaScript">
	var dev_info = get_router_info();

	var hw_version 	= dev_info.hw_ver;
	var version 	= dev_info.fw_ver;
	var model		= dev_info.model;
	var login_Info 	= dev_info.login_info;
	var cli_mac 	= dev_info.cli_mac;
	
	var param = {
		url: "get_set.ccp",
		arg: ""
	};
	param.arg = "ccp_act=get&num_inst=1";
	param.arg +="&oid_1=IGD_LANDevice_i_WLANConfiguration_i_&inst_1=11100";
	get_config_obj(param);
	
	function loadSettings(){
		var wlan0_enable = "0";
		if(config_val("lanWlanCfg_Enable_"))
			wlan0_enable = config_val("lanWlanCfg_Enable_");
		
		var beaconP = config_val("lanWlanCfg_BeaconPeriod_");
		if(beaconP)
			get_by_id("wlan0_beacon_interval").value = beaconP;
		else
			get_by_id("wlan0_beacon_interval").value = "100";
		
		var rtsThsld = config_val("lanWlanCfg_RTSThreshold_");
		if(rtsThsld)
			get_by_id("wlan0_rts_threshold").value = rtsThsld;
		else
			get_by_id("wlan0_rts_threshold").value = "2346";
		
		var frgmThsld = config_val("lanWlanCfg_FragmentThreshold_");
		if(frgmThsld)
			get_by_id("wlan0_fragmentation").value = frgmThsld;
		else
			get_by_id("wlan0_fragmentation").value = "2346";
		
		var dtimItvl = config_val("lanWlanCfg_DTIMInterval_");
		if(dtimItvl)
			get_by_id("wlan0_dtim").value = dtimItvl;
		else
			get_by_id("wlan0_dtim").value = "1";
			
		if(wlan0_enable == 0){		
			get_by_id("wlan0_beacon_interval").disabled = true;
			get_by_id("wlan0_rts_threshold").disabled = true;
			get_by_id("wlan0_fragmentation").disabled = true;
			get_by_id("wlan0_dtim").disabled = true;
			get_by_id("apply").disabled = true;
		}	
	}
		
	function check_perform(which_one){		
    	var obj;
    	var temp_obj;
    	
    	switch(which_one){
    		case 0 :
    			temp_obj = get_by_id("wlan0_beacon_interval");
    			var beacon_msg = replace_msg(check_num_msg, get_words('_BeaconInterval'), 25, 1000);
    			obj = new varible_obj(temp_obj.value, beacon_msg, 25, 1000, false);
    			break;
    		case 1 :
    			temp_obj = get_by_id("wlan0_rts_threshold");
    			var rts_msg = replace_msg(check_num_msg, get_words('_RTSthreshold'), 256, 2346);
    			obj = new varible_obj(temp_obj.value, rts_msg, 256, 2346, false);
    			break;
    		case 2 :
    			temp_obj = get_by_id("wlan0_fragmentation");
    			var frag_msg = replace_msg(check_num_msg, get_words('_MSG681'), 1500, 2346);
    			obj = new varible_obj(temp_obj.value, frag_msg, 1500, 2346, true);
    			break;
    		case 3 :
    			temp_obj = get_by_id("wlan0_dtim");
    			var dtim_msg = replace_msg(check_num_msg, get_words('_DTIMinterval'),1 ,255);
    			obj = new varible_obj(temp_obj.value, dtim_msg, 1, 255, false);
    			break;
    	}
    	
    	if (check_varible(obj)){
    		return true;
    	}else {
        	temp_obj.value = temp_obj.defaultValue;
        	return false;
    	}         
    }
	
	function send_request(){
		var is_submit = false;
    	
		for (var i = 0; i < 4; i++){
			is_submit = check_perform(i);
			
			if (!is_submit){			
				break;
    		} 
		}
	
		if (is_submit){
			copyDataToDataModelFormat();
			send_submit("form2");
		}
	}

	function copyDataToDataModelFormat()
	{
		get_by_id("lanWlanCfg_BeaconPeriod_1.1.1.0.0").value = get_by_id("wlan0_beacon_interval").value;
		get_by_id("lanWlanCfg_RTSThreshold_1.1.1.0.0").value = get_by_id("wlan0_rts_threshold").value;
		get_by_id("lanWlanCfg_FragmentThreshold_1.1.1.0.0").value = get_by_id("wlan0_fragmentation").value;
		get_by_id("lanWlanCfg_DTIMInterval_1.1.1.0.0").value = get_by_id("wlan0_dtim").value;
	}
</SCRIPT>	
</head>

<body onLoad="MM_preloadImages('but_wizard_1.gif','but_status_1.gif','but_tools_1.gif','but_main_1.gif','but_wireless_1.gif','but_routing_1.gif','but_access_1.gif','but_management_1.gif');loadSettings()">
<table width="750" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td width="21"><img src="c1_tl.gif" width="21" height="21" /></td>
    <td width="708" background="bg1_t.gif"><img src="top_1.gif" width="390" height="21" /></td>
    <td width="21"><img src="c1_tr.gif" width="21" height="21" /></td>
  </tr>
  <tr>
    <td valign="top" background="bg1_l.gif"><img src="top_2.gif" width="21" height="69" /></td>
    <td background="bg.gif"><table width="100%" border="0" cellpadding="0" cellspacing="0">
      <tr>
        <td width="13%"><img src="logo.gif" /></td>
        <td width="87%" align="right"><img src="description.gif" /></td>
      </tr>
    </table>
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td width="20%" height="429" valign="top"><table width="56%" border="0" cellpadding="0" cellspacing="0">
              <tr>
                <td onclick="location.href='lan.htm'">
				<table class="menu_tb" onMouseOver="changeMenuClass(this, 'in');" onmouseout="changeMenuClass(this, 'out');">
				<tr>
					<td class="menu_nw"></td>
					<td class="menu_n"></td>
					<td class="menu_ne"></td>
				</tr>
				<tr>
					<td class="menu_w"></td>
					<td class="menu_m"><b>&nbsp;&nbsp;<script>show_words('_MSG749');</script></td>
					<td class="menu_e"></td>
				</tr>
				<tr>
					<td class="menu_sw"></td>
					<td class="menu_s"></td>
					<td class="menu_se"></td>
				</tr>
				</table>	
				</a></td>
              </tr>
              </tr>
              <tr>
                <td><img src="spacer.gif" width="8" height="8"></td>
              </tr>
              <tr>
                <td onclick="location.href='wireless_basic.htm'">
				<table class="menu_tb">
				<tr>
					<td class="menu_sel_nw"></td>
					<td class="menu_sel_n"></td>
					<td class="menu_sel_ne"></td>
				</tr>
				<tr>
					<td class="menu_sel_w"></td>
					<td class="menu_sel_m"><b>&nbsp;&nbsp;<script>show_words('_Wireless')</script></td>
					<td class="menu_sel_e"></td>
				</tr>
				<tr>
					<td class="menu_sel_sw"></td>
					<td class="menu_sel_s"></td>
					<td class="menu_sel_se"></td>
				</tr>
				</table>
				</td>
              </tr>
              <tr>
                <td><table width="100%" border="0" cellpadding="2" class="submenubg">
                    <tr>
                      <td width="13%" align="right"><font color="#FFFFFF">&bull;</font></td>
                      <td width="87%"><a href="wireless_basic.htm" class="submenus"><b><script>show_words('_Basic');</script></b></a></td>
                    </tr>
                    <tr>
                      <td align="right"><font color="#FFFFFF">&bull;</font></td>
                      <td><a href="wireless_auth.htm" class="submenus"><b><script>show_words('_Security');</script></b></a></td>
                    </tr>
                    <tr>
                      <td align="right"><font color="#FFFFFF">&bull;</font></td>
                      <td><a href="wireless_advanced.htm" class="submenus"><b><u><script>show_words('_Advanced');</script></u></b></a></td>
                    </tr>
<!--DEF	CONFIG_WPS-->  <tr><td align="right"><font color="#FFFFFF">&bull;</font></td>
<!--DEF CONFIG_WPS-->    <td><a href="wlan_wps.htm" class="submenus"><b><script>show_words('_WiFiSetup');</script></b></a></td></tr>
                </table></td>
              </tr>
			  <tr>
                <td><img src="spacer.gif" width="8" height="8"></td>
              </tr>
              <tr>
                <td onclick="location.href='status.htm'">
				<table class="menu_tb" onMouseOver="changeMenuClass(this, 'in');" onmouseout="changeMenuClass(this, 'out');">
				<tr>
					<td class="menu_nw"></td>
					<td class="menu_n"></td>
					<td class="menu_ne"></td>
				</tr>
				<tr>
					<td class="menu_w"></td>
					<td class="menu_m"><b>&nbsp;&nbsp;<script>show_words('_MSG748')</script></td>
					<td class="menu_e"></td>
				</tr>
				<tr>
					<td class="menu_sw"></td>
					<td class="menu_s"></td>
					<td class="menu_se"></td>
				</tr>
				</table>
				</td>
              </tr>
              <tr>
                <td><img src="spacer.gif" width="8" height="8"></td>
              </tr>
              <tr>
                <td onclick="location.href='static_routing.htm'">
				<table class="menu_tb" onMouseOver="changeMenuClass(this, 'in');" onmouseout="changeMenuClass(this, 'out');">
				<tr>
					<td class="menu_nw"></td>
					<td class="menu_n"></td>
					<td class="menu_ne"></td>
				</tr>
				<tr>
					<td class="menu_w"></td>
					<td class="menu_m"><b>&nbsp;&nbsp;<script>show_words('_MSG747')</script></td>
					<td class="menu_e"></td>
				</tr>
				<tr>
					<td class="menu_sw"></td>
					<td class="menu_s"></td>
					<td class="menu_se"></td>
				</tr>
				</table>
				</td>
              </tr>
              <tr>
                <td><img src="spacer.gif" width="8" height="8"></td>
              </tr>
              <tr>
                <td onclick="location.href='filters.htm'">
				<table class="menu_tb" onMouseOver="changeMenuClass(this, 'in');" onmouseout="changeMenuClass(this, 'out');">
				<tr>
					<td class="menu_nw"></td>
					<td class="menu_n"></td>
					<td class="menu_ne"></td>
				</tr>
				<tr>
					<td class="menu_w"></td>
					<td class="menu_m"><b>&nbsp;&nbsp;<script>show_words('_Access')</script></td>
					<td class="menu_e"></td>
				</tr>
				<tr>
					<td class="menu_sw"></td>
					<td class="menu_s"></td>
					<td class="menu_se"></td>
				</tr>
				</table>
				</td>
              </tr>
              <tr>
                <td><img src="spacer.gif" width="8" height="8"></td>
              </tr>
              <tr>
                <td onclick="location.href='snmp.htm'">
				<table class="menu_tb" onMouseOver="changeMenuClass(this, 'in');" onmouseout="changeMenuClass(this, 'out');">
				<tr>
					<td class="menu_nw"></td>
					<td class="menu_n"></td>
					<td class="menu_ne"></td>
				</tr>
				<tr>
					<td class="menu_w"></td>
					<td class="menu_m"><b>&nbsp;&nbsp;<script>show_words('_MSG746')</script></td>
					<td class="menu_e"></td>
				</tr>
				<tr>
					<td class="menu_sw"></td>
					<td class="menu_s"></td>
					<td class="menu_se"></td>
				</tr>
				</table>
				</td>
              </tr>
              <tr>
                <td><img src="spacer.gif" width="8" height="8"></td>
              </tr>
              <tr>
                <td onclick="location.href='restart.htm'">
				<table class="menu_tb" onMouseOver="changeMenuClass(this, 'in');" onmouseout="changeMenuClass(this, 'out');">
				<tr>
					<td class="menu_nw"></td>
					<td class="menu_n"></td>
					<td class="menu_ne"></td>
				</tr>
				<tr>
					<td class="menu_w"></td>
					<td class="menu_m"><b>&nbsp;&nbsp;<script>show_words('_Tools')</script></td>
					<td class="menu_e"></td>
				</tr>
				<tr>
					<td class="menu_sw"></td>
					<td class="menu_s"></td>
					<td class="menu_se"></td>
				</tr>
				</table>
				</td>
              </tr>
              <tr>
                <td><img src="spacer.gif" width="8" height="8"></td>
              </tr>
              <tr>
                <td onclick="show_wizard('wizard.htm',login_Info)">
				<table class="menu_tb" onMouseOver="changeMenuClass(this, 'in');" onmouseout="changeMenuClass(this, 'out');">
				<tr>
					<td class="menu_nw"></td>
					<td class="menu_n"></td>
					<td class="menu_ne"></td>
				</tr>
				<tr>
					<td class="menu_w"></td>
					<td class="menu_m"><b>&nbsp;&nbsp;<script>show_words('_Wizard')</script></td>
					<td class="menu_e"></td>
				</tr>
				<tr>
					<td class="menu_sw"></td>
					<td class="menu_s"></td>
					<td class="menu_se"></td>
				</tr>
				</table>
				</td>
              </tr>
              <tr>
                <td><img src="spacer.gif" width="15" height="15"></td>
              </tr>
            </table>
            <p>&nbsp;</p>
              <p>&nbsp;</p></td>
            <td width="2%"><img src="spacer.gif" width="15" height="15" /></td>
            <td width="78%" valign="top"><table width="98%" border="0" cellpadding="0" cellspacing="0" class="tabBigTitle">
                <tr>
                  <td class="headerbg2"><table width="100%" border="0" cellpadding="0" cellspacing="0" style="padding: 10px 0 10px 0">
                      <tr>
                        <td width="79%"><font color="#FFFFFF" class="textheader" style="margin-left:0; padding-left:0"><script>show_words('_Advanced')</script></font></td>
                        <td width="21%"><input name="button" type="button" id="help_btn" class="ButtonHelp" onclick="MM_openBrWindow('help_wlan.htm#wireless_advanced','','scrollbars=yes,resizable=yes,width=800,height=550')" value="" />
								<script>$('#help_btn').val(get_words('_Help'));</script>
                        </td>
                      </tr>
                  </table></td>
                </tr>
                <tr>
                  <td valign="top">
				  <form id="form2" name="form2" method="post" action="get_set.ccp">
				    <input type="hidden" name="ccp_act" value="set">
					<input type="hidden" name="ccpSubEvent" value="CCP_SUB_WIRELESS">
					<input type="hidden" name="nextPage" value="wireless_advanced.htm">
					<input type="hidden" name="lanWlanCfg_BeaconPeriod_1.1.1.0.0" id="lanWlanCfg_BeaconPeriod_1.1.1.0.0" value="">
					<input type="hidden" name="lanWlanCfg_RTSThreshold_1.1.1.0.0" id="lanWlanCfg_RTSThreshold_1.1.1.0.0" value="">
					<input type="hidden" name="lanWlanCfg_FragmentThreshold_1.1.1.0.0" id="lanWlanCfg_FragmentThreshold_1.1.1.0.0" value="">
					<input type="hidden" name="lanWlanCfg_DTIMInterval_1.1.1.0.0" id="lanWlanCfg_DTIMInterval_1.1.1.0.0" value="">
				  </form>
				  <form id="form1" name="form1" method="post" action="apply.cgi">
                    <input type="hidden" id="html_response_page" name="html_response_page" value="back.htm">
                    <input type="hidden" id="html_response_message" name="html_response_message" value="The setting is saved.">
                    <input type="hidden" id="html_response_return_page" name="html_response_return_page" value="wireless_advanced.htm">
                    <input type="hidden" id="reboot_type" name="reboot_type" value="reboot">
                    <table width="98%" border="0" align="center" cellpadding="3" cellspacing="1" bgcolor="#333333">
                      <tr>
                        <td width="160" align="right" class="bgblue"><font face="Arial"><script>show_words('_BeaconInterval')</script>&nbsp;</font></td>
                        <td  class="bggrey"><font face="Arial" size="2">
                          <input type="text" id="wlan0_beacon_interval" name="wlan0_beacon_interval"  size="5" maxlength="4" value="">
                          (<script>show_words('_MSG751')</script>) </font></td>
                      </tr>
                      <tr>
                        <td width="160" align="right" class="bgblue"><font face="Arial"><script>show_words('_RTSthreshold')</script>&nbsp;</font></td>
                        <td  class="bggrey"><font face="Arial" size="2">
                          <input type="text" id="wlan0_rts_threshold" name="wlan0_rts_threshold" size="5" maxlength="4" value="">
                          (<script>show_words('_MSG752')</script>)</font></td>
                      </tr>
                      <tr>
                        <td width="160" align="right" class="bgblue" ><font face="Arial"><script>show_words('_FragThreshold')</script>&nbsp;</font></td>
                        <td  class="bggrey" ><font face="Arial" size="2">
                          <input type="text" id="wlan0_fragmentation" name="wlan0_fragmentation" size="5" maxlength="4" value="">
                          (<script>show_words('_MSG753')</script>)</font></td>
                      </tr>
                      <tr>
                        <td width="160" align="right" class="bgblue"><font face="Arial"><script>show_words('_DTIMinterval')</script>&nbsp;</font></td>
                        <td  class="bggrey"><font face="Arial" size="2">
                          <input type="text" id="wlan0_dtim" name="wlan0_dtim" size="5" maxlength="3" value="">
                          (<script>show_words('_MSG754')</script>)</font></td>
                      </tr>
                      <tr>
                        <td align="right" class="bgblue">&nbsp;</td>
                        <td bgcolor="#FFFFFF" class="bggrey2"><input name="cancel" type="button" class="ButtonSmall" id="cancel" onClick="window.location='wireless_advanced.htm'" value="">
									<script>$('#cancel').val(get_words('_Cancel'));</script>
                            <input name="apply" type="button" class="ButtonSmall" id="apply" onClick="send_request()" value="">	<script>$('#apply').val(get_words('_Apply'));</script>  
                        </td>
                      </tr>
                    </table>
                  </form>
                    <br>
                  </td>
                </tr>
            </table></td>
          </tr>
      </table></td>
    <td background="bg1_r.gif">&nbsp;</td>
  </tr>
  <tr>
    <td><img src="c1_bl.gif" width="21" height="20" /></td>
    <td align="right" background="bg1_b.gif"><img src="copyright.png" width="264" height="20" /></td>
    <td><img src="c1_br.gif" width="21" height="20" /></td>
  </tr>
</table>
<script>
var login_who=login_Info;
    if(login_who != "w")
    {
        get_by_id("cancel").disabled = "true";
        get_by_id("apply").disabled = "true";
    }
</script>
</body>
</html>
